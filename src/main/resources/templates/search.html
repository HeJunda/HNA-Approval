<!DOCTYPE html>
<html lang="en"></html>
<html lang="en" xmnls="www.thymeleaf.org" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"></meta>
    <meta name="format-detection" content="telephone=no"></meta>
    <meta name="apple-mobile-web-app-capable" content="yes"></meta>
	<title>渤海信托</title>
	<link rel="stylesheet" type="text/css" href="/css/index.css" />
</head>
<body>
	<div id="app">
		<header class="header cleanF">
	        <a href="index.html"><span class="back"></span></a>
	        <h3 class="approve">流程查询</h3>   
	    </header>
		<div class="container paddinTop">
		  <div class="follow-tab">
             <ul class="cleanF">
                <router-link tag="li" to="active">本人呈报</router-link>
                <router-link tag="li" to="person">本人审批</router-link>
              </ul>
		  </div>	      
		  
		  <router-view></router-view>
	      
		</div>
	</div>
	<script type="text/javascript" src="js/lib/vue.min.js"></script>
	<script type="text/javascript" src="js/lib/axios.min.js"></script>
	<script type="text/javascript" src="js/lib/vue-router.min.js"></script>
	<script type="text/javascript" src="js/lib/jquery.js"></script>
	<script	type="text/javascript" src="js/lib/cookies.js"></script>
	<script	type="text/javascript" src="js/lib/iscroll.js"></script>
	<script type="text/javascript" src="js/lib/layer.js"></script>
	<script> 
	var actives={
		    template:`<div class="agency-list">
						 <div class="search">
						     <div class="search-box">
						         <input type="text" placeholder="请输入流程名称"/><span class="search-btn fr v-on:click='sears()"><i class="search-icon"></i>搜索</span>
						     </div>
						 </div>
			             <div>
			                  <ul>
			                    <li class="clearfix">
			                       <div class="agency-right">
			                       <div class="right-box">
			                         <h3 class="agency-title">资金划付</h3>
			                         <p class="follow-present"><span>当前审批人：</span>张扬</p>
			                         <p class="follow-present"><span>当前审批部门：</span>信托投资部门</p>
			                         <span class="arrow fr"></span>
			                         </div>
			                       </div>
			                    </li>
			                  </ul>
			             </div> 
		              </div>`
		  }
		  var persons={
			 template:`<div class="agency-list">
							
					<div class="search">
					    <div class="search-box">
					        <input type="text" placeholder="请输入项目名称" id="gulpwork"/><span class="search-btn fr" v-on:click='sears()'><i class="search-icon"></i>搜索</span>
					    </div>
					</div>

				   	<ul>
				      <li class="clearfix" v-for="item in dataes">
				         <div class="agency-right">
				            <div class="right-box">
				           <h3 class="agency-title">{{item.flowname}}</h3>
				           <p class="follow-person">发起人：<span class="fr">{{item.startername}}</span></p>
				           <p class="follow-person">发起时间：<span class="fr">{{item.starttime}}</span></p>
				           <p class="follow-person">当前审批人：<span class="fr">{{item.assigneename}}</span></p>
				           <p class="follow-person">当前审批部门：<span class="fr">{{item.startorg}}</span></p>
				           <span class="prompt fr">{{item.flowstatus}}</span>
				           </div>
				         </div>
				      </li>
				    </ul>
				</div>`,
				data:function(){
					return{
						dataes:[]
					}
				},
				created:function(){
					  var _this=this;
					  var user=getCookie('userid')
					  axios.get("/workflow/getMyInitiatedProcess",{params:{userid:user,start:0,limit:10}}).then(function(response){
						 console.log(response.data)
						  _this.dataes=response.data;
						  console.log(_this.dataes)
					  }).catch(function(error){
						  console.log(error);
					  });
				},
				methods:{
					sears:function(){
						var gulpwork=$("#gulpwork").val();
						console.log(gulpwork)
						if(gulpwork==""){
							alert("查询内容不能为空");
						}else{
							var _this=this;
							var user=getCookie('userid')
							axios.get("/workflow/getMyInitiatedProcess",{params:{userid:user,start:0,flowname:gulpwork}}).then(function(response){
								console.log(response.data)
								console.log(response.data[0])
								_this.dataes=response.data
							}).catch(function(error){
								console.log(error);
							});	
						}
					}
				}
		  }
		  const routers = [
		    {
		      path:"",
		      redirect:'/active'
		    },
		    {
		      path:"/active",
		      component:actives
		    },
		    {
		      path:"/person",
		      component:persons
		    }
		  ]

		  const routeres = new VueRouter({
		      routes: routers
		    })

		  new Vue({
		    router:routeres
		  }).$mount("#app")
	</script>
</body>
	
</html>